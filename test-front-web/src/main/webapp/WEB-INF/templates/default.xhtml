<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="#{userManagedBean.language}" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

	<h:head>
		<f:facet name="first">
			<meta http-equiv="X-UA-Compatible" content="IE=10" />
			<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
			<link rel="shortcut icon"
				href="#{resource['suitair-lib:img/suitair.ico']}"
				type="image/x-icon" />
			<h:outputScript library="suitair-lib" name="js/jsfutil.js" />
			<title>#{msg.generic_title} - Prorate</title>
		</f:facet>
	</h:head>

	<h:body>

		<!-- p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />
		 
		<p:dialog widgetVar="statusDialog" modal="false" draggable="false" closable="false" resizable="false" showHeader="false">
		    <p:graphicImage value="#{resource['suitair-lib:img/ajaxloading.gif']}" />
		</p:dialog-->

		<p:growl id="msgsGrowl" showSummary="true" showDetail="true"
			life="2500" autoUpdate="true" />

		<!-- p:socket onMessage="handleNotification" channel="/notifications">
			<p:ajax event="message" update="infobarButonsForm" />
		</p:socket>

		<script type="text/javascript">
			// Prueba - lanino
			function handleNotification(data){
				console.log(data);
			}
		</script-->

		<p:layout fullPage="true">

			<p:layoutUnit position="north" size="50" resizable="false"
				closable="false" collapsible="false" styleClass="FondoCabecera">

				<h:form id="infobarDocSearchForm"
					style="display: inline; float: left;">

					<h:panelGroup id="docSearch">

						<p:inputText size="15" placeholder="demo" />
						<p:button icon="ui-icon-search" />

					</h:panelGroup>

				</h:form>

				<p:spacer width="100" height="10" />

				<h:outputText
					value="#{userManagedBean.name} #{userManagedBean.lastName}" styleClass="Arial13Boldwhite"/>

				<p:spacer width="100" height="10" />

				<h:form id="infobarButonsForm"
					style="display: inline; float: right;">

					<h:outputText id="numberUserNotifications"
						value="#{numberUserNotifications}" rendered="#{numberUserNotifications gt 0}"
						style="position: absolute;color: black;z-index: 400;right: 42px;top: 6px;background-color: red;font-family: Arial,Verdana, sans-serif;font-size: 10px; padding: 1px;" />

					<p:commandButton icon="ui-icon-favorites-suitair" ajax="true"
						process="@this" styleClass="IcoHeader" />
					<p:commandButton icon="ui-icon-companies-suitair" ajax="true"
						process="@this" styleClass="IcoHeader" />
					<p:commandButton icon="ui-icon-process-suitair" ajax="true"
						process="@this" styleClass="IcoHeader" />

					<p:commandButton id="notificationBtn" type="button"
						icon="ui-icon-notifications-suitair" ajax="true" process="@this"
						styleClass="IcoHeader" />

					<p:overlayPanel id="notificationPanel" for="notificationBtn"
						dismissable="true" hideEffect="fade" dynamic="true"
						appendToBody="true" style="width:200px;">

						<p:dataTable id="notificationTable" value="#{userNotifications}"
							var="notif" rendered="#{not empty userNotifications}">

							<p:column headerText="Severity">
								<h:outputText value="#{notif.severity}" />
							</p:column>

							<p:column headerText="Message">
								<h:outputText value="#{notif.message}" />
							</p:column>

						</p:dataTable>

					</p:overlayPanel>

					<p:commandButton icon="ui-icon-help-suitair" ajax="true"
						process="@this" styleClass="IcoHeader" />

				</h:form>

			</p:layoutUnit>

			<p:layoutUnit position="west" effect="fade" collapsible="true" styleClass="menubackground"
				collapsed="true" resizable="true" size="200" minSize="200"
				maxSize="200" header="Menu">

				<ui:insert name="menu">Menu</ui:insert>

			</p:layoutUnit>

			<p:layoutUnit position="center" styleClass="contentbackground">

				<ui:insert name="content">Content</ui:insert>

			</p:layoutUnit>

			<p:layoutUnit position="south" styleClass="footbackground" size="3">
			</p:layoutUnit>

		</p:layout>

		<p:ajaxExceptionHandler
			type="javax.faces.application.ViewExpiredException"
			update="exceptionDialog" onexception="PF('exceptionDialog').show();" />

		<p:dialog id="exceptionDialog" header="#{pfExceptionHandler.type}"
			widgetVar="exceptionDialog">
			Message: #{pfExceptionHandler.message} <br />
			Trace: <h:outputText
				value="#{pfExceptionHandler.formattedStackTrace}" escape="false" />
			<p:button onclick="document.location.href = document.location.href"
				value="Reload" />
		</p:dialog>

	</h:body>

</html>
